{% extends 'base_new.html' %}
{% load static %}

{% block title %}Change Password - CSU Tracker{% endblock %}

{% block extra_head %}
<style>
.password-form {
    background: var(--bg-primary);
    border: 1px solid var(--border-subtle);
    border-radius: var(--radius-xl);
    padding: var(--space-5);
}
.password-requirements {
    background: var(--bg-secondary);
    border-radius: var(--radius-lg);
    padding: var(--space-4);
    margin-bottom: var(--space-5);
}
.password-requirements__title {
    font-size: var(--text-sm);
    font-weight: 600;
    color: var(--text-primary);
    margin-bottom: var(--space-2);
}
.password-requirements__list {
    font-size: var(--text-sm);
    color: var(--text-secondary);
    list-style: disc;
    padding-left: var(--space-5);
}
.password-requirements__list li {
    margin-bottom: var(--space-1);
}
</style>
{% endblock %}

{% block header_left %}
<a href="{% url 'notifications:settings' %}" class="btn btn--icon btn--ghost" aria-label="Back to settings">
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
        <path d="M19 12H5M12 19l-7-7 7-7"/>
    </svg>
</a>
{% endblock %}

{% block header_title %}Change Password{% endblock %}

{% block content %}
<div class="app-content fade-in">
    
    <!-- Security Icon -->
    <div class="text-center mb-5">
        <div style="width: 64px; height: 64px; margin: 0 auto; background: var(--color-primary-50); border-radius: 50%; display: flex; align-items: center; justify-content: center;">
            <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="var(--color-primary-500)" stroke-width="2">
                <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
                <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
            </svg>
        </div>
        <h2 class="text-xl font-bold text-primary mt-4">Update Your Password</h2>
        <p class="text-sm text-secondary mt-1">Choose a strong, unique password</p>
    </div>
    
    <!-- Password Requirements -->
    <div class="password-requirements">
        <h3 class="password-requirements__title">Password Requirements</h3>
        <ul class="password-requirements__list">
            <li>At least 8 characters long</li>
            <li>Not too similar to your email</li>
            <li>Not a commonly used password</li>
            <li>Not entirely numeric</li>
        </ul>
    </div>
    
    <!-- Form -->
    <form method="post" class="password-form">
        {% csrf_token %}
        
        {% if form.errors %}
        <div class="feedback-banner feedback-banner--error mb-4">
            <svg class="feedback-banner__icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"/><line x1="15" y1="9" x2="9" y2="15"/><line x1="9" y1="9" x2="15" y2="15"/>
            </svg>
            <span class="feedback-banner__text">
                {% for field, errors in form.errors.items %}
                    {% for error in errors %}{{ error }}{% if not forloop.last %} {% endif %}{% endfor %}
                {% endfor %}
            </span>
        </div>
        {% endif %}
        
        <div class="form-group">
            <label class="form-label" for="id_old_password">Current Password</label>
            {{ form.old_password }}
        </div>
        
        <div class="form-group">
            <label class="form-label" for="id_new_password1">New Password</label>
            {{ form.new_password1 }}
        </div>
        
        <div class="form-group">
            <label class="form-label" for="id_new_password2">Confirm New Password</label>
            {{ form.new_password2 }}
        </div>
        
        <button type="submit" class="btn btn--primary btn--full mt-4">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                <polyline points="22 4 12 14.01 9 11.01"/>
            </svg>
            Update Password
        </button>
    </form>
    
    <p class="text-sm text-tertiary text-center mt-4">
        You'll remain logged in after changing your password.
    </p>
</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/components.js' %}"></script>
{% endblock %}
