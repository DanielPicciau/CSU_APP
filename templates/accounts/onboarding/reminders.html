{% extends 'accounts/onboarding/base.html' %}

{% block title %}Reminders - CSU Tracker{% endblock %}

{% block content %}
<div class="onboarding-step">
    <h1 class="onboarding-step__title">
        Would you like daily reminders?
    </h1>
    
    <p class="onboarding-step__subtitle">
        A gentle nudge helps build consistency. Most people find it takes just 30 seconds to log.
    </p>
    
    <form method="post" class="onboarding-form" id="reminders-form">
        {% csrf_token %}
        <input type="hidden" name="action" value="next" id="form-action">
        
        <div class="onboarding-options onboarding-options--stacked">
            <label class="onboarding-option onboarding-option--wide">
                <input type="radio" name="enable_reminders" value="yes" 
                       {% if form.enable_reminders.value == 'yes' %}checked{% endif %}
                       class="onboarding-option__input"
                       onchange="toggleReminderTime(true)">
                <span class="onboarding-option__card onboarding-option__card--detailed">
                    <span class="onboarding-option__icon">ðŸ””</span>
                    <span class="onboarding-option__label">Yes, remind me daily</span>
                    <span class="onboarding-option__description">Get a notification at your preferred time</span>
                </span>
            </label>
            
            <label class="onboarding-option onboarding-option--wide">
                <input type="radio" name="enable_reminders" value="no"
                       {% if form.enable_reminders.value == 'no' %}checked{% endif %}
                       class="onboarding-option__input"
                       onchange="toggleReminderTime(false)">
                <span class="onboarding-option__card onboarding-option__card--detailed">
                    <span class="onboarding-option__icon">ðŸ”•</span>
                    <span class="onboarding-option__label">No thanks</span>
                    <span class="onboarding-option__description">I'll log on my own</span>
                </span>
            </label>
        </div>
        
        <!-- Time Picker (shown when reminders enabled) -->
        <div class="onboarding-time-picker" id="time-picker" style="{% if form.enable_reminders.value != 'yes' %}display: none;{% endif %}">
            <label class="onboarding-time-picker__label">
                What time works best for you?
            </label>
            <div class="onboarding-time-picker__input-wrapper">
                <input type="time" name="reminder_time" 
                       value="{{ form.reminder_time.value|default:'20:00' }}"
                       class="onboarding-time-picker__input">
            </div>
            <p class="onboarding-time-picker__hint">
                Tip: Evening works well for reflecting on your day
            </p>
        </div>
        
        <p class="onboarding-reassurance">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"/>
                <path d="M12 16v-4"/>
                <path d="M12 8h.01"/>
            </svg>
            You can change this anytime in Settings.
        </p>
    </form>
</div>

<script>
function toggleReminderTime(show) {
    const picker = document.getElementById('time-picker');
    if (picker) {
        picker.style.display = show ? 'block' : 'none';
    }
}
</script>
{% endblock %}

{% block navigation %}
<button type="submit" form="reminders-form" class="btn btn--primary btn--lg btn--full">
    Continue
</button>

<div class="onboarding-nav-row">
    <button type="button" onclick="document.getElementById('form-action').value='back'; document.getElementById('reminders-form').submit();" class="btn btn--ghost">
        Back
    </button>
    <button type="button" onclick="document.getElementById('form-action').value='skip'; document.getElementById('reminders-form').submit();" class="btn btn--ghost">
        Skip
    </button>
</div>
{% endblock %}
